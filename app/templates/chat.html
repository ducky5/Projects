{% extends 'uniform/base.html' %}

{% block css_files %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/chat.css') }}">
{% endblock %}

{% block title %}Chat{% endblock %}

{% block content %}
<div class="chat-container">
  <div class="recipient-username">{{ recipient_username }}</div>

  <div class="scrollable-chat" id="scrollable-chat">
    {% for message in messages %}
    {% if message.sender_id == current_user.id and not
    message.is_auto_generated %}
    <div class="sender-pronoun">You</div>
    {% elif message.sender_id == current_user.id and
    message.is_auto_generated %}
    {% else %}
    {% if message.is_auto_generated %}
    <div class="recipient-pronoun">[AUTO-GENERATED]</div>
    {% else %}
    {% if recipient_gender == 'female' %}
    <div class="recipient-pronoun">Her</div>
    {% else %}
    <div class="recipient-pronoun">Him</div>
    {% endif %}
    {% endif %}
    {% endif %}

    {% if message.sender_id == current_user.id and not
    message.is_auto_generated %}
    <div class="sender-message messages"
    MESSAGE_ID="{{ message.id }}">{{ message.message }}</div>
    {% elif message.sender_id == recipient_id %}
    <div class="recipient-message messages"
    MESSAGE_ID="{{ message.id }}">{{ message.message }}</div>
    {% endif %}

    {% endfor %}

  </div>

  <div class="send-message">
    <textarea type="text" name="message" placeholder="type here..."
    id="text-to-send"></textarea>
    <button type="button" name="send" id="send-text"
    RECIPIENT_ID="{{ recipient_id }}">
      <i class="fas fa-paper-plane"></i>
    </button>
  </div>
</div>
{% endblock %}

{% block javascript %}
<!-- socketio library -->
<script src="{{ url_for('static', filename='js/external_libraries/socketio.js')
}}"></script>
<!-- chat.js -->
<script src="{{ url_for('static', filename='js/chat.js') }}"></script>
{% endblock %}
